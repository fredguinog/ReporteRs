library(XML)

context("docx office chart")

test_that("test1A: update barchart with two series using two value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test1.docx" ))

	categoricalcolumn1 <- c(1990, 1991, 1992)
	valuecolumn1 <- c(6, 78, 12)
	valuecolumn2 <- c(5, 1, 50)
	df <- data.frame(categoricalcolumn1, valuecolumn1, valuecolumn2)

	doc <- try( chart_updateData( doc, bookmark = "TEST1CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST1CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:ns17=\"urn:schemas-microsoft-com:office:excel\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:title>\n            <c:tx>\n                <c:rich>\n                    <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:r>\n                            <a:rPr lang=\"pt-BR\"/>\n                            <a:t>teste</a:t>\n                        </a:r>\n                    </a:p>\n                </c:rich>\n            </c:tx>\n            <c:overlay val=\"false\"/>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n            <c:txPr>\n                <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                <a:lstStyle/>\n                <a:p>\n                    <a:pPr>\n                        <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"65000\"/>\n                                    <a:lumOff val=\"35000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:latin typeface=\"+mn-lt\"/>\n                            <a:ea typeface=\"+mn-ea\"/>\n                            <a:cs typeface=\"+mn-cs\"/>\n                        </a:defRPr>\n                    </a:pPr>\n                    <a:endParaRPr lang=\"pt-BR\"/>\n                </a:p>\n            </c:txPr>\n        </c:title>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:barChart>\n                <c:barDir val=\"col\"/>\n                <c:grouping val=\"clustered\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent1\"/>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:cat>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:numRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"1\"/>\n                    <c:order val=\"1\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$C$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent2\"/>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:cat>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:numRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$C$2:$C$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:gapWidth val=\"219\"/>\n                <c:overlap val=\"-27\"/>\n                <c:axId val=\"50026240\"/>\n                <c:axId val=\"48848512\"/>\n            </c:barChart>\n            <c:catAx>\n                <c:axId val=\"50026240\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"15000\"/>\n                                <a:lumOff val=\"85000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"48848512\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:auto val=\"true\"/>\n                <c:lblAlgn val=\"ctr\"/>\n                <c:lblOffset val=\"100\"/>\n                <c:noMultiLvlLbl val=\"false\"/>\n            </c:catAx>\n            <c:valAx>\n                <c:axId val=\"48848512\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln>\n                        <a:noFill/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"50026240\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"between\"/>\n            </c:valAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test1B: update barchart with two series using one value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test1.docx" ))

	categoricalcolumn1 <- c(1990, 1991, 1992)
	valuecolumn1 <- c(6, 78, 12)
	df <- data.frame(categoricalcolumn1, valuecolumn1)

	doc <- try( chart_updateData( doc, bookmark = "TEST1CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST1CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:ns18=\"urn:schemas-microsoft-com:office:excel\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:title>\n            <c:tx>\n                <c:rich>\n                    <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:r>\n                            <a:rPr lang=\"pt-BR\"/>\n                            <a:t>teste</a:t>\n                        </a:r>\n                    </a:p>\n                </c:rich>\n            </c:tx>\n            <c:overlay val=\"false\"/>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n            <c:txPr>\n                <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                <a:lstStyle/>\n                <a:p>\n                    <a:pPr>\n                        <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"65000\"/>\n                                    <a:lumOff val=\"35000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:latin typeface=\"+mn-lt\"/>\n                            <a:ea typeface=\"+mn-ea\"/>\n                            <a:cs typeface=\"+mn-cs\"/>\n                        </a:defRPr>\n                    </a:pPr>\n                    <a:endParaRPr lang=\"pt-BR\"/>\n                </a:p>\n            </c:txPr>\n        </c:title>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:barChart>\n                <c:barDir val=\"col\"/>\n                <c:grouping val=\"clustered\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent1\"/>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:cat>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:numRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:gapWidth val=\"219\"/>\n                <c:overlap val=\"-27\"/>\n                <c:axId val=\"50026240\"/>\n                <c:axId val=\"48848512\"/>\n            </c:barChart>\n            <c:catAx>\n                <c:axId val=\"50026240\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"15000\"/>\n                                <a:lumOff val=\"85000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"48848512\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:auto val=\"true\"/>\n                <c:lblAlgn val=\"ctr\"/>\n                <c:lblOffset val=\"100\"/>\n                <c:noMultiLvlLbl val=\"false\"/>\n            </c:catAx>\n            <c:valAx>\n                <c:axId val=\"48848512\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln>\n                        <a:noFill/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"50026240\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"between\"/>\n            </c:valAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test1C: update barchart with two series using three value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test1.docx" ))

	categoricalcolumn1 <- c(1990, 1991, 1992)
	valuecolumn1 <- c(6, 78, 12)
	valuecolumn2 <- c(5, 1, 50)
	valuecolumn3 <- c(11, 7, 21)
	df <- data.frame(categoricalcolumn1, valuecolumn1, valuecolumn2, valuecolumn3)

	doc <- try( chart_updateData( doc, bookmark = "TEST1CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST1CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:ns17=\"urn:schemas-microsoft-com:office:excel\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:title>\n            <c:tx>\n                <c:rich>\n                    <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:r>\n                            <a:rPr lang=\"pt-BR\"/>\n                            <a:t>teste</a:t>\n                        </a:r>\n                    </a:p>\n                </c:rich>\n            </c:tx>\n            <c:overlay val=\"false\"/>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n            <c:txPr>\n                <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                <a:lstStyle/>\n                <a:p>\n                    <a:pPr>\n                        <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"65000\"/>\n                                    <a:lumOff val=\"35000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:latin typeface=\"+mn-lt\"/>\n                            <a:ea typeface=\"+mn-ea\"/>\n                            <a:cs typeface=\"+mn-cs\"/>\n                        </a:defRPr>\n                    </a:pPr>\n                    <a:endParaRPr lang=\"pt-BR\"/>\n                </a:p>\n            </c:txPr>\n        </c:title>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:barChart>\n                <c:barDir val=\"col\"/>\n                <c:grouping val=\"clustered\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent1\"/>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:cat>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:numRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"1\"/>\n                    <c:order val=\"1\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$C$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent2\"/>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:cat>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:numRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$C$2:$C$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"2\"/>\n                    <c:order val=\"2\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$D$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent1\"/>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:cat>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:numRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$D$2:$D$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:gapWidth val=\"219\"/>\n                <c:overlap val=\"-27\"/>\n                <c:axId val=\"50026240\"/>\n                <c:axId val=\"48848512\"/>\n            </c:barChart>\n            <c:catAx>\n                <c:axId val=\"50026240\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"15000\"/>\n                                <a:lumOff val=\"85000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"48848512\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:auto val=\"true\"/>\n                <c:lblAlgn val=\"ctr\"/>\n                <c:lblOffset val=\"100\"/>\n                <c:noMultiLvlLbl val=\"false\"/>\n            </c:catAx>\n            <c:valAx>\n                <c:axId val=\"48848512\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln>\n                        <a:noFill/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"50026240\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"between\"/>\n            </c:valAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test2A: update lineChart with two series using two value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test2.docx" ))

	categoricalcolumn1 <- c(1990, 1991, 1992)
	valuecolumn1 <- c(6, 78, 12)
	valuecolumn2 <- c(5, 1, 50)
	df <- data.frame(categoricalcolumn1, valuecolumn1, valuecolumn2)

	doc <- try( chart_updateData( doc, bookmark = "TEST2CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST2CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:ns18=\"urn:schemas-microsoft-com:office:excel\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:title>\n            <c:tx>\n                <c:rich>\n                    <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:r>\n                            <a:rPr lang=\"pt-BR\"/>\n                            <a:t>teste</a:t>\n                        </a:r>\n                    </a:p>\n                </c:rich>\n            </c:tx>\n            <c:overlay val=\"false\"/>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n            <c:txPr>\n                <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                <a:lstStyle/>\n                <a:p>\n                    <a:pPr>\n                        <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"65000\"/>\n                                    <a:lumOff val=\"35000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:latin typeface=\"+mn-lt\"/>\n                            <a:ea typeface=\"+mn-ea\"/>\n                            <a:cs typeface=\"+mn-cs\"/>\n                        </a:defRPr>\n                    </a:pPr>\n                    <a:endParaRPr lang=\"pt-BR\"/>\n                </a:p>\n            </c:txPr>\n        </c:title>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:lineChart>\n                <c:grouping val=\"standard\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"28575\" cap=\"rnd\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent1\"/>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"none\"/>\n                    </c:marker>\n                    <c:cat>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:numRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"1\"/>\n                    <c:order val=\"1\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$C$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"28575\" cap=\"rnd\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent2\"/>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"none\"/>\n                    </c:marker>\n                    <c:cat>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:numRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$C$2:$C$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:smooth val=\"false\"/>\n                <c:axId val=\"217602384\"/>\n                <c:axId val=\"217605184\"/>\n            </c:lineChart>\n            <c:catAx>\n                <c:axId val=\"217602384\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"15000\"/>\n                                <a:lumOff val=\"85000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"217605184\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:auto val=\"true\"/>\n                <c:lblAlgn val=\"ctr\"/>\n                <c:lblOffset val=\"100\"/>\n                <c:noMultiLvlLbl val=\"false\"/>\n            </c:catAx>\n            <c:valAx>\n                <c:axId val=\"217605184\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln>\n                        <a:noFill/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"217602384\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"between\"/>\n            </c:valAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test2B: update lineChart with two series using one value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test2.docx" ))

	categoricalcolumn1 <- c(1990, 1991, 1992)
	valuecolumn1 <- c(6, 78, 12)
	df <- data.frame(categoricalcolumn1, valuecolumn1)

	doc <- try( chart_updateData( doc, bookmark = "TEST2CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST2CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:ns18=\"urn:schemas-microsoft-com:office:excel\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:title>\n            <c:tx>\n                <c:rich>\n                    <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:r>\n                            <a:rPr lang=\"pt-BR\"/>\n                            <a:t>teste</a:t>\n                        </a:r>\n                    </a:p>\n                </c:rich>\n            </c:tx>\n            <c:overlay val=\"false\"/>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n            <c:txPr>\n                <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                <a:lstStyle/>\n                <a:p>\n                    <a:pPr>\n                        <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"65000\"/>\n                                    <a:lumOff val=\"35000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:latin typeface=\"+mn-lt\"/>\n                            <a:ea typeface=\"+mn-ea\"/>\n                            <a:cs typeface=\"+mn-cs\"/>\n                        </a:defRPr>\n                    </a:pPr>\n                    <a:endParaRPr lang=\"pt-BR\"/>\n                </a:p>\n            </c:txPr>\n        </c:title>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:lineChart>\n                <c:grouping val=\"standard\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"28575\" cap=\"rnd\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent1\"/>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"none\"/>\n                    </c:marker>\n                    <c:cat>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:numRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:smooth val=\"false\"/>\n                <c:axId val=\"217602384\"/>\n                <c:axId val=\"217605184\"/>\n            </c:lineChart>\n            <c:catAx>\n                <c:axId val=\"217602384\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"15000\"/>\n                                <a:lumOff val=\"85000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"217605184\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:auto val=\"true\"/>\n                <c:lblAlgn val=\"ctr\"/>\n                <c:lblOffset val=\"100\"/>\n                <c:noMultiLvlLbl val=\"false\"/>\n            </c:catAx>\n            <c:valAx>\n                <c:axId val=\"217605184\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln>\n                        <a:noFill/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"217602384\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"between\"/>\n            </c:valAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test2C: update lineChart with two series using three value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test2.docx" ))

	categoricalcolumn1 <- c(1990, 1991, 1992)
	valuecolumn1 <- c(6, 78, 12)
	valuecolumn2 <- c(5, 1, 50)
	valuecolumn3 <- c(11, 7, 21)
	df <- data.frame(categoricalcolumn1, valuecolumn1, valuecolumn2, valuecolumn3)

	doc <- try( chart_updateData( doc, bookmark = "TEST2CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST2CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:ns17=\"urn:schemas-microsoft-com:office:excel\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:title>\n            <c:tx>\n                <c:rich>\n                    <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:r>\n                            <a:rPr lang=\"pt-BR\"/>\n                            <a:t>teste</a:t>\n                        </a:r>\n                    </a:p>\n                </c:rich>\n            </c:tx>\n            <c:overlay val=\"false\"/>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n            <c:txPr>\n                <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                <a:lstStyle/>\n                <a:p>\n                    <a:pPr>\n                        <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"65000\"/>\n                                    <a:lumOff val=\"35000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:latin typeface=\"+mn-lt\"/>\n                            <a:ea typeface=\"+mn-ea\"/>\n                            <a:cs typeface=\"+mn-cs\"/>\n                        </a:defRPr>\n                    </a:pPr>\n                    <a:endParaRPr lang=\"pt-BR\"/>\n                </a:p>\n            </c:txPr>\n        </c:title>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:lineChart>\n                <c:grouping val=\"standard\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"28575\" cap=\"rnd\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent1\"/>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"none\"/>\n                    </c:marker>\n                    <c:cat>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:numRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"1\"/>\n                    <c:order val=\"1\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$C$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"28575\" cap=\"rnd\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent2\"/>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"none\"/>\n                    </c:marker>\n                    <c:cat>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:numRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$C$2:$C$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"2\"/>\n                    <c:order val=\"2\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$D$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"28575\" cap=\"rnd\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent1\"/>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"none\"/>\n                    </c:marker>\n                    <c:cat>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:numRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$D$2:$D$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:smooth val=\"false\"/>\n                <c:axId val=\"217602384\"/>\n                <c:axId val=\"217605184\"/>\n            </c:lineChart>\n            <c:catAx>\n                <c:axId val=\"217602384\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"15000\"/>\n                                <a:lumOff val=\"85000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"217605184\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:auto val=\"true\"/>\n                <c:lblAlgn val=\"ctr\"/>\n                <c:lblOffset val=\"100\"/>\n                <c:noMultiLvlLbl val=\"false\"/>\n            </c:catAx>\n            <c:valAx>\n                <c:axId val=\"217605184\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln>\n                        <a:noFill/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"217602384\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"between\"/>\n            </c:valAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test3A: update scatterChart with two series using two value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test3.docx" ))

	valuecolumn1 <- c(6, 78, 12, 17, 83, 89, 62, 72)
	valuecolumn2 <- c(5, 1, 50, 7, 24, 82, 11, 24)
	valuecolumn3 <- c(74, 28, 24, 73, 24, 11, 29, 88)
	df <- data.frame(valuecolumn1, valuecolumn2, valuecolumn3)

	doc <- try( chart_updateData( doc, bookmark = "TEST3CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST3CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns19=\"urn:schemas-microsoft-com:office:excel\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:scatterChart>\n                <c:scatterStyle val=\"lineMarker\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"19050\" cap=\"rnd\">\n                            <a:noFill/>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"circle\"/>\n                        <c:size val=\"5\"/>\n                        <c:spPr>\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent1\"/>\n                            </a:solidFill>\n                            <a:ln w=\"9525\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"accent1\"/>\n                                </a:solidFill>\n                            </a:ln>\n                            <a:effectLst/>\n                        </c:spPr>\n                    </c:marker>\n                    <c:xVal>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$9</c:f>\n                        </c:numRef>\n                    </c:xVal>\n                    <c:yVal>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$9</c:f>\n                        </c:numRef>\n                    </c:yVal>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"1\"/>\n                    <c:order val=\"1\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$C$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"25400\" cap=\"rnd\">\n                            <a:noFill/>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"circle\"/>\n                        <c:size val=\"5\"/>\n                        <c:spPr>\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent2\"/>\n                            </a:solidFill>\n                            <a:ln w=\"9525\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"accent2\"/>\n                                </a:solidFill>\n                            </a:ln>\n                            <a:effectLst/>\n                        </c:spPr>\n                    </c:marker>\n                    <c:xVal>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$9</c:f>\n                        </c:numRef>\n                    </c:xVal>\n                    <c:yVal>\n                        <c:numRef>\n                            <c:f>Plan1!$C$2:$C$9</c:f>\n                        </c:numRef>\n                    </c:yVal>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:axId val=\"267368752\"/>\n                <c:axId val=\"267364832\"/>\n            </c:scatterChart>\n            <c:valAx>\n                <c:axId val=\"267368752\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"25000\"/>\n                                <a:lumOff val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"267364832\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"midCat\"/>\n            </c:valAx>\n            <c:valAx>\n                <c:axId val=\"267364832\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"25000\"/>\n                                <a:lumOff val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"267368752\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"midCat\"/>\n            </c:valAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test3B: update scatterChart with two series using one value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test3.docx" ))

	valuecolumn1 <- c(6, 78, 12, 17, 83, 89, 62, 72)
	valuecolumn2 <- c(5, 1, 50, 7, 24, 82, 11, 24)
	df <- data.frame(valuecolumn1, valuecolumn2)

	doc <- try( chart_updateData( doc, bookmark = "TEST3CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST3CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:ns17=\"urn:schemas-microsoft-com:office:excel\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:scatterChart>\n                <c:scatterStyle val=\"lineMarker\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"19050\" cap=\"rnd\">\n                            <a:noFill/>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"circle\"/>\n                        <c:size val=\"5\"/>\n                        <c:spPr>\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent1\"/>\n                            </a:solidFill>\n                            <a:ln w=\"9525\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"accent1\"/>\n                                </a:solidFill>\n                            </a:ln>\n                            <a:effectLst/>\n                        </c:spPr>\n                    </c:marker>\n                    <c:xVal>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$9</c:f>\n                        </c:numRef>\n                    </c:xVal>\n                    <c:yVal>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$9</c:f>\n                        </c:numRef>\n                    </c:yVal>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:axId val=\"267368752\"/>\n                <c:axId val=\"267364832\"/>\n            </c:scatterChart>\n            <c:valAx>\n                <c:axId val=\"267368752\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"25000\"/>\n                                <a:lumOff val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"267364832\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"midCat\"/>\n            </c:valAx>\n            <c:valAx>\n                <c:axId val=\"267364832\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"25000\"/>\n                                <a:lumOff val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"267368752\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"midCat\"/>\n            </c:valAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test3C: update scatterChart with two series using three value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test3.docx" ))

	valuecolumn1 <- c(6, 78, 12, 17, 83, 89, 62, 72)
	valuecolumn2 <- c(5, 1, 50, 7, 24, 82, 11, 24)
	valuecolumn3 <- c(74, 28, 24, 73, 24, 11, 29, 88)
	valuecolumn4 <- c(28, 29, 82, 98, 22, 55, 15, 59)
	df <- data.frame(valuecolumn1, valuecolumn2, valuecolumn3, valuecolumn4)

	doc <- try( chart_updateData( doc, bookmark = "TEST3CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST3CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:ns17=\"urn:schemas-microsoft-com:office:excel\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:scatterChart>\n                <c:scatterStyle val=\"lineMarker\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"19050\" cap=\"rnd\">\n                            <a:noFill/>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"circle\"/>\n                        <c:size val=\"5\"/>\n                        <c:spPr>\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent1\"/>\n                            </a:solidFill>\n                            <a:ln w=\"9525\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"accent1\"/>\n                                </a:solidFill>\n                            </a:ln>\n                            <a:effectLst/>\n                        </c:spPr>\n                    </c:marker>\n                    <c:xVal>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$9</c:f>\n                        </c:numRef>\n                    </c:xVal>\n                    <c:yVal>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$9</c:f>\n                        </c:numRef>\n                    </c:yVal>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"1\"/>\n                    <c:order val=\"1\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$C$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"25400\" cap=\"rnd\">\n                            <a:noFill/>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"circle\"/>\n                        <c:size val=\"5\"/>\n                        <c:spPr>\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent2\"/>\n                            </a:solidFill>\n                            <a:ln w=\"9525\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"accent2\"/>\n                                </a:solidFill>\n                            </a:ln>\n                            <a:effectLst/>\n                        </c:spPr>\n                    </c:marker>\n                    <c:xVal>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$9</c:f>\n                        </c:numRef>\n                    </c:xVal>\n                    <c:yVal>\n                        <c:numRef>\n                            <c:f>Plan1!$C$2:$C$9</c:f>\n                        </c:numRef>\n                    </c:yVal>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"2\"/>\n                    <c:order val=\"2\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$D$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"19050\" cap=\"rnd\">\n                            <a:noFill/>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"circle\"/>\n                        <c:size val=\"5\"/>\n                        <c:spPr>\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent1\"/>\n                            </a:solidFill>\n                            <a:ln w=\"9525\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"accent1\"/>\n                                </a:solidFill>\n                            </a:ln>\n                            <a:effectLst/>\n                        </c:spPr>\n                    </c:marker>\n                    <c:xVal>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$9</c:f>\n                        </c:numRef>\n                    </c:xVal>\n                    <c:yVal>\n                        <c:numRef>\n                            <c:f>Plan1!$D$2:$D$9</c:f>\n                        </c:numRef>\n                    </c:yVal>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:axId val=\"267368752\"/>\n                <c:axId val=\"267364832\"/>\n            </c:scatterChart>\n            <c:valAx>\n                <c:axId val=\"267368752\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"25000\"/>\n                                <a:lumOff val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"267364832\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"midCat\"/>\n            </c:valAx>\n            <c:valAx>\n                <c:axId val=\"267364832\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"25000\"/>\n                                <a:lumOff val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"267368752\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"midCat\"/>\n            </c:valAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test4A: update bubbleChart with two series using two value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test4.docx" ))

	valuecolumn1 <- c(6, 78, 12, 17, 83, 89, 62, 72)
	valuecolumn2 <- c(5, 1, 50, 7, 24, 82, 11, 24)
	sizecolumn2 <- c(1, 2, 3, 4, 5, 6, 7 , 8)
	valuecolumn3 <- c(74, 28, 24, 73, 24, 11, 29, 88)
	sizecolumn3 <- c(8, 7, 6, 5, 4, 3, 2, 1)
	df <- data.frame(valuecolumn1, valuecolumn2, sizecolumn2, valuecolumn3, sizecolumn3)

	doc <- try( chart_updateData( doc, bookmark = "TEST4CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST4CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns19=\"urn:schemas-microsoft-com:office:excel\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:bubbleChart>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent1\">\n                                <a:alpha val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:xVal>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$9</c:f>\n                        </c:numRef>\n                    </c:xVal>\n                    <c:yVal>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$9</c:f>\n                        </c:numRef>\n                    </c:yVal>\n                    <c:bubbleSize>\n                        <c:numRef>\n                            <c:f>Plan1!$C$2:$C$9</c:f>\n                        </c:numRef>\n                    </c:bubbleSize>\n                    <c:bubble3D val=\"false\"/>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"1\"/>\n                    <c:order val=\"1\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$D$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent2\">\n                                <a:alpha val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:ln w=\"25400\">\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:xVal>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$9</c:f>\n                        </c:numRef>\n                    </c:xVal>\n                    <c:yVal>\n                        <c:numRef>\n                            <c:f>Plan1!$D$2:$D$9</c:f>\n                        </c:numRef>\n                    </c:yVal>\n                    <c:bubbleSize>\n                        <c:numRef>\n                            <c:f>Plan1!$E$2:$E$9</c:f>\n                        </c:numRef>\n                    </c:bubbleSize>\n                    <c:bubble3D val=\"false\"/>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:bubbleScale val=\"100\"/>\n                <c:showNegBubbles val=\"false\"/>\n                <c:axId val=\"203500832\"/>\n                <c:axId val=\"203501392\"/>\n            </c:bubbleChart>\n            <c:valAx>\n                <c:axId val=\"203500832\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"25000\"/>\n                                <a:lumOff val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"203501392\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"midCat\"/>\n            </c:valAx>\n            <c:valAx>\n                <c:axId val=\"203501392\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"25000\"/>\n                                <a:lumOff val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"203500832\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"midCat\"/>\n            </c:valAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test4B: update bubbleChart with two series using one value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test4.docx" ))

	valuecolumn1 <- c(6, 78, 12, 17, 83, 89, 62, 72)
	valuecolumn2 <- c(5, 1, 50, 7, 24, 82, 11, 24)
	sizecolumn2 <- c(1, 2, 3, 4, 5, 6, 7 , 8)
	df <- data.frame(valuecolumn1, valuecolumn2, sizecolumn2)

	doc <- try( chart_updateData( doc, bookmark = "TEST4CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST4CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:ns17=\"urn:schemas-microsoft-com:office:excel\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:bubbleChart>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent1\">\n                                <a:alpha val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:xVal>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$9</c:f>\n                        </c:numRef>\n                    </c:xVal>\n                    <c:yVal>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$9</c:f>\n                        </c:numRef>\n                    </c:yVal>\n                    <c:bubbleSize>\n                        <c:numRef>\n                            <c:f>Plan1!$C$2:$C$9</c:f>\n                        </c:numRef>\n                    </c:bubbleSize>\n                    <c:bubble3D val=\"false\"/>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:bubbleScale val=\"100\"/>\n                <c:showNegBubbles val=\"false\"/>\n                <c:axId val=\"203500832\"/>\n                <c:axId val=\"203501392\"/>\n            </c:bubbleChart>\n            <c:valAx>\n                <c:axId val=\"203500832\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"25000\"/>\n                                <a:lumOff val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"203501392\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"midCat\"/>\n            </c:valAx>\n            <c:valAx>\n                <c:axId val=\"203501392\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"25000\"/>\n                                <a:lumOff val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"203500832\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"midCat\"/>\n            </c:valAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test4C: update bubbleChart with two series using three value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test4.docx" ))

	valuecolumn1 <- c(6, 78, 12, 17, 83, 89, 62, 72)
	valuecolumn2 <- c(5, 1, 50, 7, 24, 82, 11, 24)
	sizecolumn2 <- c(1, 2, 3, 4, 5, 6, 7 , 8)
	valuecolumn3 <- c(74, 28, 24, 73, 24, 11, 29, 88)
	sizecolumn3 <- c(8, 7, 6, 5, 4, 3, 2, 1)
	valuecolumn4 <- c(39, 11, 52, 63, 19, 23, 10,8)
	sizecolumn4 <- c(8, 7, 6, 5, 4, 3, 2, 1)
	df <- data.frame(valuecolumn1, valuecolumn2, sizecolumn2, valuecolumn3, sizecolumn3, valuecolumn4, sizecolumn4)

	doc <- try( chart_updateData( doc, bookmark = "TEST4CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST4CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:ns17=\"urn:schemas-microsoft-com:office:excel\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:bubbleChart>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent1\">\n                                <a:alpha val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:xVal>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$9</c:f>\n                        </c:numRef>\n                    </c:xVal>\n                    <c:yVal>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$9</c:f>\n                        </c:numRef>\n                    </c:yVal>\n                    <c:bubbleSize>\n                        <c:numRef>\n                            <c:f>Plan1!$C$2:$C$9</c:f>\n                        </c:numRef>\n                    </c:bubbleSize>\n                    <c:bubble3D val=\"false\"/>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"1\"/>\n                    <c:order val=\"1\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$D$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent2\">\n                                <a:alpha val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:ln w=\"25400\">\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:xVal>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$9</c:f>\n                        </c:numRef>\n                    </c:xVal>\n                    <c:yVal>\n                        <c:numRef>\n                            <c:f>Plan1!$D$2:$D$9</c:f>\n                        </c:numRef>\n                    </c:yVal>\n                    <c:bubbleSize>\n                        <c:numRef>\n                            <c:f>Plan1!$E$2:$E$9</c:f>\n                        </c:numRef>\n                    </c:bubbleSize>\n                    <c:bubble3D val=\"false\"/>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"2\"/>\n                    <c:order val=\"2\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$F$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent1\">\n                                <a:alpha val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:xVal>\n                        <c:numRef>\n                            <c:f>Plan1!$A$2:$A$9</c:f>\n                        </c:numRef>\n                    </c:xVal>\n                    <c:yVal>\n                        <c:numRef>\n                            <c:f>Plan1!$F$2:$F$9</c:f>\n                        </c:numRef>\n                    </c:yVal>\n                    <c:bubbleSize>\n                        <c:numRef>\n                            <c:f>Plan1!$G$2:$G$9</c:f>\n                        </c:numRef>\n                    </c:bubbleSize>\n                    <c:bubble3D val=\"false\"/>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:bubbleScale val=\"100\"/>\n                <c:showNegBubbles val=\"false\"/>\n                <c:axId val=\"203500832\"/>\n                <c:axId val=\"203501392\"/>\n            </c:bubbleChart>\n            <c:valAx>\n                <c:axId val=\"203500832\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"25000\"/>\n                                <a:lumOff val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"203501392\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"midCat\"/>\n            </c:valAx>\n            <c:valAx>\n                <c:axId val=\"203501392\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"25000\"/>\n                                <a:lumOff val=\"75000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"203500832\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"midCat\"/>\n            </c:valAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test5A: update combochart with three series using three value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test5.docx" ))

	categoricalcolumn1 <- c(1990, 1991, 1992)
	valuecolumn1 <- c(6, 78, 12)
	valuecolumn2 <- c(5, 1, 50)
	valuecolumn3 <- c(11, 7, 21)
	df <- data.frame(categoricalcolumn1, valuecolumn1, valuecolumn2, valuecolumn3)

	doc <- try( chart_updateData( doc, bookmark = "TEST5CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST5CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns19=\"urn:schemas-microsoft-com:office:excel\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:title>\n            <c:overlay val=\"false\"/>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n            <c:txPr>\n                <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                <a:lstStyle/>\n                <a:p>\n                    <a:pPr>\n                        <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"65000\"/>\n                                    <a:lumOff val=\"35000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:latin typeface=\"+mn-lt\"/>\n                            <a:ea typeface=\"+mn-ea\"/>\n                            <a:cs typeface=\"+mn-cs\"/>\n                        </a:defRPr>\n                    </a:pPr>\n                    <a:endParaRPr lang=\"pt-BR\"/>\n                </a:p>\n            </c:txPr>\n        </c:title>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:barChart>\n                <c:barDir val=\"col\"/>\n                <c:grouping val=\"clustered\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent1\"/>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:cat>\n                        <c:strRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:strRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:gapWidth val=\"219\"/>\n                <c:overlap val=\"-27\"/>\n                <c:axId val=\"208418896\"/>\n                <c:axId val=\"208422256\"/>\n            </c:barChart>\n            <c:lineChart>\n                <c:grouping val=\"standard\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"1\"/>\n                    <c:order val=\"1\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$C$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"28575\" cap=\"rnd\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent2\"/>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"none\"/>\n                    </c:marker>\n                    <c:cat>\n                        <c:strRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:strRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$C$2:$C$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"2\"/>\n                    <c:order val=\"2\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$D$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"28575\" cap=\"rnd\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent3\"/>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"none\"/>\n                    </c:marker>\n                    <c:cat>\n                        <c:strRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:strRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$D$2:$D$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:marker val=\"true\"/>\n                <c:smooth val=\"false\"/>\n                <c:axId val=\"208423376\"/>\n                <c:axId val=\"208422816\"/>\n            </c:lineChart>\n            <c:catAx>\n                <c:axId val=\"208418896\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"15000\"/>\n                                <a:lumOff val=\"85000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"208422256\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:auto val=\"true\"/>\n                <c:lblAlgn val=\"ctr\"/>\n                <c:lblOffset val=\"100\"/>\n                <c:noMultiLvlLbl val=\"false\"/>\n            </c:catAx>\n            <c:valAx>\n                <c:axId val=\"208422256\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln>\n                        <a:noFill/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"208418896\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"between\"/>\n            </c:valAx>\n            <c:valAx>\n                <c:axId val=\"208422816\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"r\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"out\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln>\n                        <a:noFill/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"208423376\"/>\n                <c:crosses val=\"max\"/>\n                <c:crossBetween val=\"between\"/>\n            </c:valAx>\n            <c:catAx>\n                <c:axId val=\"208423376\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"true\"/>\n                <c:axPos val=\"b\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"out\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:crossAx val=\"208422816\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:auto val=\"true\"/>\n                <c:lblAlgn val=\"ctr\"/>\n                <c:lblOffset val=\"100\"/>\n                <c:noMultiLvlLbl val=\"false\"/>\n            </c:catAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:legend>\n            <c:legendPos val=\"b\"/>\n            <c:overlay val=\"false\"/>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n            <c:txPr>\n                <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                <a:lstStyle/>\n                <a:p>\n                    <a:pPr>\n                        <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"65000\"/>\n                                    <a:lumOff val=\"35000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:latin typeface=\"+mn-lt\"/>\n                            <a:ea typeface=\"+mn-ea\"/>\n                            <a:cs typeface=\"+mn-cs\"/>\n                        </a:defRPr>\n                    </a:pPr>\n                    <a:endParaRPr lang=\"pt-BR\"/>\n                </a:p>\n            </c:txPr>\n        </c:legend>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test5B: update combochart with three series using two value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test5.docx" ))

	categoricalcolumn1 <- c(1990, 1991, 1992)
	valuecolumn1 <- c(6, 78, 12)
	valuecolumn2 <- c(5, 1, 50)
	df <- data.frame(categoricalcolumn1, valuecolumn1, valuecolumn2)

	doc <- try( chart_updateData( doc, bookmark = "TEST5CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST5CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns19=\"urn:schemas-microsoft-com:office:excel\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:title>\n            <c:overlay val=\"false\"/>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n            <c:txPr>\n                <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                <a:lstStyle/>\n                <a:p>\n                    <a:pPr>\n                        <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"65000\"/>\n                                    <a:lumOff val=\"35000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:latin typeface=\"+mn-lt\"/>\n                            <a:ea typeface=\"+mn-ea\"/>\n                            <a:cs typeface=\"+mn-cs\"/>\n                        </a:defRPr>\n                    </a:pPr>\n                    <a:endParaRPr lang=\"pt-BR\"/>\n                </a:p>\n            </c:txPr>\n        </c:title>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:barChart>\n                <c:barDir val=\"col\"/>\n                <c:grouping val=\"clustered\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent1\"/>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:cat>\n                        <c:strRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:strRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:gapWidth val=\"219\"/>\n                <c:overlap val=\"-27\"/>\n                <c:axId val=\"208418896\"/>\n                <c:axId val=\"208422256\"/>\n            </c:barChart>\n            <c:lineChart>\n                <c:grouping val=\"standard\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"1\"/>\n                    <c:order val=\"1\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$C$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"28575\" cap=\"rnd\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent2\"/>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"none\"/>\n                    </c:marker>\n                    <c:cat>\n                        <c:strRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:strRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$C$2:$C$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:marker val=\"true\"/>\n                <c:smooth val=\"false\"/>\n                <c:axId val=\"208423376\"/>\n                <c:axId val=\"208422816\"/>\n            </c:lineChart>\n            <c:catAx>\n                <c:axId val=\"208418896\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"15000\"/>\n                                <a:lumOff val=\"85000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"208422256\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:auto val=\"true\"/>\n                <c:lblAlgn val=\"ctr\"/>\n                <c:lblOffset val=\"100\"/>\n                <c:noMultiLvlLbl val=\"false\"/>\n            </c:catAx>\n            <c:valAx>\n                <c:axId val=\"208422256\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln>\n                        <a:noFill/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"208418896\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"between\"/>\n            </c:valAx>\n            <c:valAx>\n                <c:axId val=\"208422816\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"r\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"out\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln>\n                        <a:noFill/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"208423376\"/>\n                <c:crosses val=\"max\"/>\n                <c:crossBetween val=\"between\"/>\n            </c:valAx>\n            <c:catAx>\n                <c:axId val=\"208423376\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"true\"/>\n                <c:axPos val=\"b\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"out\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:crossAx val=\"208422816\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:auto val=\"true\"/>\n                <c:lblAlgn val=\"ctr\"/>\n                <c:lblOffset val=\"100\"/>\n                <c:noMultiLvlLbl val=\"false\"/>\n            </c:catAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:legend>\n            <c:legendPos val=\"b\"/>\n            <c:overlay val=\"false\"/>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n            <c:txPr>\n                <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                <a:lstStyle/>\n                <a:p>\n                    <a:pPr>\n                        <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"65000\"/>\n                                    <a:lumOff val=\"35000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:latin typeface=\"+mn-lt\"/>\n                            <a:ea typeface=\"+mn-ea\"/>\n                            <a:cs typeface=\"+mn-cs\"/>\n                        </a:defRPr>\n                    </a:pPr>\n                    <a:endParaRPr lang=\"pt-BR\"/>\n                </a:p>\n            </c:txPr>\n        </c:legend>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})

test_that("test5C: update combochart with three series using four value-column data.frame", {
	doc <- docx( template = paste0(system.file("tests", package = "ReporteRs"), "/testthat/test-docx-office-chart_test5.docx" ))

	categoricalcolumn1 <- c(1990, 1991, 1992)
	valuecolumn1 <- c(6, 78, 12)
	valuecolumn2 <- c(5, 1, 50)
	valuecolumn3 <- c(11, 7, 21)
	valuecolumn4 <- c(2, 17, 8)
	df <- data.frame(categoricalcolumn1, valuecolumn1, valuecolumn2, valuecolumn3, valuecolumn4)

	doc <- try( chart_updateData( doc, bookmark = "TEST5CHART", newData = df, ncolxaxis = 1L ), silent = TRUE )

	processed <- xmlParse(chart_extractXML( doc, "TEST5CHART" )[1])

	reference <- xmlParse("<c:chartSpace xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:ns21=\"urn:schemas-microsoft-com:office:powerpoint\" xmlns:ns23=\"http://schemas.microsoft.com/office/2006/coverPageProps\" xmlns:dsp=\"http://schemas.microsoft.com/office/drawing/2008/diagram\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:odx=\"http://opendope.org/xpaths\" xmlns:odgm=\"http://opendope.org/SmartArt/DataHierarchy\" xmlns:dgm=\"http://schemas.openxmlformats.org/drawingml/2006/diagram\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:odi=\"http://opendope.org/components\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:ns19=\"urn:schemas-microsoft-com:office:excel\" xmlns:ns9=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:ns32=\"http://schemas.openxmlformats.org/drawingml/2006/lockedCanvas\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\" xmlns:ns30=\"http://schemas.openxmlformats.org/officeDocument/2006/bibliography\" xmlns:ns12=\"http://schemas.openxmlformats.org/drawingml/2006/chartDrawing\" xmlns:ns31=\"http://schemas.openxmlformats.org/drawingml/2006/compatibility\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:odq=\"http://opendope.org/questions\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:xdr=\"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing\" xmlns:odc=\"http://opendope.org/conditions\" xmlns:oda=\"http://opendope.org/answers\">\n    <c:date1904 val=\"false\"/>\n    <c:lang val=\"pt-BR\"/>\n    <c:roundedCorners val=\"false\"/>\n    <c:style val=\"2\"/>\n    <c:chart>\n        <c:title>\n            <c:overlay val=\"false\"/>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n            <c:txPr>\n                <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                <a:lstStyle/>\n                <a:p>\n                    <a:pPr>\n                        <a:defRPr sz=\"1400\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" spc=\"0\" baseline=\"0\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"65000\"/>\n                                    <a:lumOff val=\"35000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:latin typeface=\"+mn-lt\"/>\n                            <a:ea typeface=\"+mn-ea\"/>\n                            <a:cs typeface=\"+mn-cs\"/>\n                        </a:defRPr>\n                    </a:pPr>\n                    <a:endParaRPr lang=\"pt-BR\"/>\n                </a:p>\n            </c:txPr>\n        </c:title>\n        <c:autoTitleDeleted val=\"false\"/>\n        <c:plotArea>\n            <c:layout/>\n            <c:barChart>\n                <c:barDir val=\"col\"/>\n                <c:grouping val=\"clustered\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"0\"/>\n                    <c:order val=\"0\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$B$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:solidFill>\n                            <a:schemeClr val=\"accent1\"/>\n                        </a:solidFill>\n                        <a:ln>\n                            <a:noFill/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:invertIfNegative val=\"false\"/>\n                    <c:cat>\n                        <c:strRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:strRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$B$2:$B$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:gapWidth val=\"219\"/>\n                <c:overlap val=\"-27\"/>\n                <c:axId val=\"208418896\"/>\n                <c:axId val=\"208422256\"/>\n            </c:barChart>\n            <c:lineChart>\n                <c:grouping val=\"standard\"/>\n                <c:varyColors val=\"false\"/>\n                <c:ser>\n                    <c:idx val=\"1\"/>\n                    <c:order val=\"1\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$C$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"28575\" cap=\"rnd\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent2\"/>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"none\"/>\n                    </c:marker>\n                    <c:cat>\n                        <c:strRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:strRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$C$2:$C$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"2\"/>\n                    <c:order val=\"2\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$D$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"28575\" cap=\"rnd\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent3\"/>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"none\"/>\n                    </c:marker>\n                    <c:cat>\n                        <c:strRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:strRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$D$2:$D$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:ser>\n                    <c:idx val=\"3\"/>\n                    <c:order val=\"3\"/>\n                    <c:tx>\n                        <c:strRef>\n                            <c:f>Plan1!$E$1</c:f>\n                        </c:strRef>\n                    </c:tx>\n                    <c:spPr>\n                        <a:ln w=\"28575\" cap=\"rnd\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"accent2\"/>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                    <c:marker>\n                        <c:symbol val=\"none\"/>\n                    </c:marker>\n                    <c:cat>\n                        <c:strRef>\n                            <c:f>Plan1!$A$2:$A$4</c:f>\n                        </c:strRef>\n                    </c:cat>\n                    <c:val>\n                        <c:numRef>\n                            <c:f>Plan1!$E$2:$E$4</c:f>\n                        </c:numRef>\n                    </c:val>\n                    <c:smooth val=\"false\"/>\n                </c:ser>\n                <c:dLbls>\n                    <c:showLegendKey val=\"false\"/>\n                    <c:showVal val=\"false\"/>\n                    <c:showCatName val=\"false\"/>\n                    <c:showSerName val=\"false\"/>\n                    <c:showPercent val=\"false\"/>\n                    <c:showBubbleSize val=\"false\"/>\n                </c:dLbls>\n                <c:marker val=\"true\"/>\n                <c:smooth val=\"false\"/>\n                <c:axId val=\"208423376\"/>\n                <c:axId val=\"208422816\"/>\n            </c:lineChart>\n            <c:catAx>\n                <c:axId val=\"208418896\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"b\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                        <a:solidFill>\n                            <a:schemeClr val=\"tx1\">\n                                <a:lumMod val=\"15000\"/>\n                                <a:lumOff val=\"85000\"/>\n                            </a:schemeClr>\n                        </a:solidFill>\n                        <a:round/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"208422256\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:auto val=\"true\"/>\n                <c:lblAlgn val=\"ctr\"/>\n                <c:lblOffset val=\"100\"/>\n                <c:noMultiLvlLbl val=\"false\"/>\n            </c:catAx>\n            <c:valAx>\n                <c:axId val=\"208422256\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"l\"/>\n                <c:majorGridlines>\n                    <c:spPr>\n                        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"15000\"/>\n                                    <a:lumOff val=\"85000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:round/>\n                        </a:ln>\n                        <a:effectLst/>\n                    </c:spPr>\n                </c:majorGridlines>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"none\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln>\n                        <a:noFill/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"208418896\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:crossBetween val=\"between\"/>\n            </c:valAx>\n            <c:valAx>\n                <c:axId val=\"208422816\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"false\"/>\n                <c:axPos val=\"r\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"out\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:spPr>\n                    <a:noFill/>\n                    <a:ln>\n                        <a:noFill/>\n                    </a:ln>\n                    <a:effectLst/>\n                </c:spPr>\n                <c:txPr>\n                    <a:bodyPr rot=\"-60000000\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                    <a:lstStyle/>\n                    <a:p>\n                        <a:pPr>\n                            <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                                <a:solidFill>\n                                    <a:schemeClr val=\"tx1\">\n                                        <a:lumMod val=\"65000\"/>\n                                        <a:lumOff val=\"35000\"/>\n                                    </a:schemeClr>\n                                </a:solidFill>\n                                <a:latin typeface=\"+mn-lt\"/>\n                                <a:ea typeface=\"+mn-ea\"/>\n                                <a:cs typeface=\"+mn-cs\"/>\n                            </a:defRPr>\n                        </a:pPr>\n                        <a:endParaRPr lang=\"pt-BR\"/>\n                    </a:p>\n                </c:txPr>\n                <c:crossAx val=\"208423376\"/>\n                <c:crosses val=\"max\"/>\n                <c:crossBetween val=\"between\"/>\n            </c:valAx>\n            <c:catAx>\n                <c:axId val=\"208423376\"/>\n                <c:scaling>\n                    <c:orientation val=\"minMax\"/>\n                </c:scaling>\n                <c:delete val=\"true\"/>\n                <c:axPos val=\"b\"/>\n                <c:numFmt formatCode=\"General\" sourceLinked=\"true\"/>\n                <c:majorTickMark val=\"out\"/>\n                <c:minorTickMark val=\"none\"/>\n                <c:tickLblPos val=\"nextTo\"/>\n                <c:crossAx val=\"208422816\"/>\n                <c:crosses val=\"autoZero\"/>\n                <c:auto val=\"true\"/>\n                <c:lblAlgn val=\"ctr\"/>\n                <c:lblOffset val=\"100\"/>\n                <c:noMultiLvlLbl val=\"false\"/>\n            </c:catAx>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n        </c:plotArea>\n        <c:legend>\n            <c:legendPos val=\"b\"/>\n            <c:overlay val=\"false\"/>\n            <c:spPr>\n                <a:noFill/>\n                <a:ln>\n                    <a:noFill/>\n                </a:ln>\n                <a:effectLst/>\n            </c:spPr>\n            <c:txPr>\n                <a:bodyPr rot=\"0\" spcFirstLastPara=\"true\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"true\"/>\n                <a:lstStyle/>\n                <a:p>\n                    <a:pPr>\n                        <a:defRPr sz=\"900\" b=\"false\" i=\"false\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\n                            <a:solidFill>\n                                <a:schemeClr val=\"tx1\">\n                                    <a:lumMod val=\"65000\"/>\n                                    <a:lumOff val=\"35000\"/>\n                                </a:schemeClr>\n                            </a:solidFill>\n                            <a:latin typeface=\"+mn-lt\"/>\n                            <a:ea typeface=\"+mn-ea\"/>\n                            <a:cs typeface=\"+mn-cs\"/>\n                        </a:defRPr>\n                    </a:pPr>\n                    <a:endParaRPr lang=\"pt-BR\"/>\n                </a:p>\n            </c:txPr>\n        </c:legend>\n        <c:plotVisOnly val=\"true\"/>\n        <c:dispBlanksAs val=\"gap\"/>\n        <c:showDLblsOverMax val=\"false\"/>\n    </c:chart>\n    <c:spPr>\n        <a:solidFill>\n            <a:schemeClr val=\"bg1\"/>\n        </a:solidFill>\n        <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n                <a:schemeClr val=\"tx1\">\n                    <a:lumMod val=\"15000\"/>\n                    <a:lumOff val=\"85000\"/>\n                </a:schemeClr>\n            </a:solidFill>\n            <a:round/>\n        </a:ln>\n        <a:effectLst/>\n    </c:spPr>\n    <c:txPr>\n        <a:bodyPr/>\n        <a:lstStyle/>\n        <a:p>\n            <a:pPr>\n                <a:defRPr/>\n            </a:pPr>\n            <a:endParaRPr lang=\"pt-BR\"/>\n        </a:p>\n    </c:txPr>\n    <c:externalData r:id=\"rId3\">\n        <c:autoUpdate val=\"false\"/>\n    </c:externalData>\n</c:chartSpace>")

	# NODES AND ATTRIBUTES COMPARISON
	a = unlist(xmlToList(processed))
	if(any(names(a) %in% c("style.val")))
	  a = a[-grep("style.val", names(a))]

	b = unlist(xmlToList(reference))
	if(any(names(b) %in% c("style.val")))
	  b = b[-grep("style.val", names(b))]

	expect_equal(a, b)
})